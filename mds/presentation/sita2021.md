---
marp: true
theme: custom
---
<!--
paginate: true
-->

<!--
_class: title
-->
# 原稿
## draft

### 久永健
#### 2021-11-26
<!-- 
[Ctrl] + [Alt] + [Shift] + [i]
で"Insert Date String"を用いて年月日を挿入できる. 
-->

---
# 目次

- 本研究では, 圧縮センシングとLASSOの概要と具体的なアルゴリズムについて述べ,  
- 続いて複数ノードによる観測を行う分散圧縮センシングの問題設定, そして分散圧縮センシングにおける手法の一つDAMPと通信コスト削減のために用いられるアルゴリズムについて紹介します. また, ここで本研究の目的を説明したいと思います. 
- その後, 本研究での提案手法を説明し, またさらに通信コスト削減手法を提案します. 
- そして, それまで紹介したアルゴリズムと提案手法を用いて数値シミュレーションを行い性能を比較します. 
- 最後に、簡単なまとめで発表を締めたいと思います. 

---
# 圧縮センシング
<!-- 
_header: "準備: 圧縮センシングとLASSO"
-->
まずは, 準備として「圧縮センシングとLASSO」から説明します. 

- N次元ベクトルの原信号に対して，Nより小さい回数の観測を行い，それを基に原信号の復元を行う問題です. 

- 本研究では, 右図のような, 原信号$\bm{x}$に対し, 観測行列$\bm{A}$を用いて線形観測を行い観測信号$\bm{y}$を得るモデルを考えます. 
- このとき, 観測雑音がないとしても, 方程式の数よりも変数の個数が多い劣決定な連立一次方程式となり, 一般的には一意に解を定めることができません.

- しかし、原信号が疎である場合, 元の原信号に近い値を持つ推定解を求めることができます。

---
# LASSO
<!-- 
_header: "準備: 圧縮センシングとLASSO"
-->
先ほど述べた問題において観測雑音の影響がある場合, 
- 観測信号$\bm{y}$と$\bm{A}\hat{\bm{x}}$との二乗誤差と$\hat{\bm{x}}$のL1ノルムの和が最小になる推定解を探るLASSOという手法があります. 
	- ここで、$\lambda$は正則化パラメータで, 観測雑音の影響を考慮して設定されます. 


---
# LASSO
<!-- 
_header: "準備: 圧縮センシングとLASSO"
-->
- LASSOに対する基本的な求解アルゴリズムとしてISTAがあります. 
	- ISTAは以下の2式を交互に繰り返すことで原信号の再構成を行います. 
		- 一つ目の式では, LASSOの第一項に関する勾配降下を
		- 二つ目の式では, LASSOの第二項に関する劣勾配降下に相当する処理を行っています. 
		- 二つ目の式で用いられる関数$\eta_\mathrm{soft}$は軟判定閾値関数と呼ばれる非線形的な関数です. 右図のような形をしています. 
	- しかし, ISTAは$\lambda$が極端に小さすぎると計算が不安定になったり, 大きすぎると推定解にたどり着けなかったりと, $\lambda$を適切に設定できなければ, 精度の高い再構成を行うことができません. 

---
# AMP
<!-- 
_header: "準備: 圧縮センシングとLASSO"
-->
次に、AMPを紹介します。

- AMPは確率伝搬法に基づく手法で, その導出の結果, AMPの更新式はISTAの更新式にOnsager項を付加した形で表されます. 
- また, 状態発展法と呼ばれる推定解と原信号との平均二乗誤差の変化を計算する手法で, 理論的に性能を解析することができます. 

- AMPは観測行列の各成分が独立同分布かつガウス分布に従う行列, i.i.d.ガウス行列を用いない場合, 精度の高い再構成が実行できず状態発展法による理論的な性能解析が困難になることが問題点として挙げられます. 


---
# OAMP
<!-- 
_header: "準備: 圧縮センシングとLASSO"
-->
OAMPはAMPに関する観測行列の制約が緩和されるアルゴリズムです. 

- OAMPはAMPよりも広いクラスの観測行列を用いても精度の高い再構成を実行でき, 状態発展法による性能解析も行うことができます. 
- OAMPでは, ISTAやAMPで用いた軟判定閾値関数ではなくDivergence-Free関数を用います. 
- また, 最終ステップで用いられる関数はDivergence-Free関数である必要はありません.  


---
# OAMP
<!-- 
_header: "準備: 圧縮センシングとLASSO"
-->
- OAMPはAMPよりも広いクラスの観測行列を用いても精度の高い再構成をおこなえますが, そのような観測行列の一つとしてユニタリ不変行列があります.
	- これは観測行列を特異値分解した形において, $\bm{V}, \bm{D}, \bm{U}$が互いに独立で, $\bm{V}, \bm{U}$がハール分布に従う直交行列の場合での観測行列の事を指します. 

	- 本研究では$\bm{D}$を下の二式に従うように設定します. 

- また, 再構成の更新式で用いられた$\bm{W}$は任意の$\hat{\bm{W}}$から以下の式で生成されます. 
	- 本研究では, この$\hat{\bm{W}}$の候補として以下の三つを用います.
	- この中で, 線形最小二乗誤差, LMMSEは最も最適な形として用いられます. 
	- しかし, 各反復ごとに更新しなければならないため計算コストが余計にかかります. 

---
# 分散圧縮センシング
<!-- 
_header: "分散圧縮センシング"
-->
分散圧縮センシングは複数個の観測ノードで分散的に原信号を観測し, 各観測信号をもとに再構成を行う問題です. 

- ここで, $\bm{y}_p$, $\bm{A}_p$, $\bm{n}_p$はそれぞれ観測ノード$p$における観測信号, 観測行列, そして観測雑音を指します. 

- 本研究では, 互いに通信を行わず、各々で更新に必要な値を計算する観測ノードを周辺ノード,  
- 周辺ノードと直接通信でき, 共有された値で推定値を更新する観測ノードを中央ノードとして設定します. 
- 右図において小さな青丸が周辺ノード, 大きな青丸が中央ノードを表しています. 

- 各観測ノードにおける観測信号をまとめると下のような数式で表されます. 

- また, 標準的な圧縮センシングは分散圧縮センシングでの$P = 1$に相当します. 


---
# 分散的近似メッセージ伝搬法
<!-- 
_header: "分散圧縮センシング"
-->
分散圧縮センシングにおける手法の一つとしてHanらによって提案されたDAMPがあります. 

- DAMPはAMPを分散環境に適用させたアルゴリズムです. 
- AMPと同様に状態発展法で理論的な性能解析を行えます. 
- また, $P = 1$の場合AMPと等価になります. 

- しかし, DAMPはAMPと同様に観測行列にi.i.d.ガウス行列を用いない場合, 精度の高い再構成や状態発展法による性能解析が難しくなるという問題があります. 

- HanらはDAMPに対して，観測ノード間の通信コストを削減する手法を提案しました. 
---
# GCAMP
<!-- 
_header: "分散圧縮センシング"
-->
- Hanらが提案した通信コスト削減法の説明の前に, もう一度推定解の更新に用いる軟判定閾値関数を示します. 
	- これは図のように閾値$\lambda$よりも$r$の絶対値が小さいと$0$になります. 
	- そのため, 更新した後に非零となる値が重要です. 

- したがって, 周辺ノードから閾値を超えそうな成分だけを中央ノードに集約することで通信コストを抑えることができます. 
	- 例えば閾値が$3$の場合, 左の配列の$-5$と$4$のみを中央ノードに送ることで通信コストを抑えながら推定解の更新を行えます. 

---
# GCAMP
<!-- 
_header: "分散圧縮センシング"
-->
- このように処理を行う手法として, HanらはGCAMPを提案しました. 
- GCAMPは4つの処理から構成され, 
	- STEP1では, 閾値の平均値を調節した値を基準に, 各ノードで超過する絶対値を持つ成分のみを中央ノードと通信し共有します. 
	- STEP2では, 中央ノードで集約した成分をもとに各$n$の上限を計算し, 各要素で上限が閾値を超える$n$の成分を各ノードに要求します. 
	- STEP3では, 各ノードで中央ノードから要求された成分のうち, STEP1で共有しなかった成分のみ中央ノードに送信します. 
	- STEP4では, このように集約された閾値を超える可能性のある候補に対して, 軟判定閾値関数を用いることで推定解を更新します. 

---
# 研究目的
<!-- 
_header: "分散圧縮センシング"
-->
次に, これまで紹介した手法の関係を踏まえ本研究の目的を説明します. 

- 非分散環境において, OAMPはAMPに関する観測行列の制約が緩和される手法で, より広いクラスの観測行列を用いることができます. 

- 一方, 分散環境において, DAMPはAMPと同様な観測行列の制約を有しています. 

- そこで, 本研究ではOAMPを分散環境に適用させることで, DAMPよりも広いクラスの観測行列を用いることができる, 分散圧縮センシングの新たな手法を提案します. 
	- 提案手法は精度の高い再構成や状態発展法による性能解析ができます. 
	- また, 通信コストを削減するためにDAMPに適用させたGCAMPは提案手法に直接用いることができないため, 新たな通信コスト削減手法を提案します. 

---
# 分散的直交近似メッセージ伝搬法
<!-- 
_header: "提案手法: 分散的直交近似メッセージ伝搬法"
-->
それでは, 本研究での提案手法である「分散的直交近似メッセージ伝搬法」を説明したいと思います. 

提案手法を以後, Distributed OAMP, DOAMPと呼びます. 
- DOAMPはOAMPを分散環境に適用させた手法で, 
- OAMPと同様に状態発展法による性能解析を行うことができます. 
- また, $P = 1$の場合OAMPと等価になります. 
- 更新式で用いられる行列$\bm{W}_p$は, OAMPで説明した行列$\bm{W}$をノードごとの観測行列に従い, 割り当てて作成したものです. 

---
# 分散的直交近似メッセージ伝搬法
<!-- 
_header: "提案手法: 分散的直交近似メッセージ伝搬法"
-->
- DOAMPの状態発展法は左上の3式で構成されます. 
	- $\tau$は更新時の閾値, $v$は更新式で用いられる行列$\bm{W}$のLMMSEの場合に用いられます. 
	- しかし, 実際に再構成する際には原信号は未知であるためこれらの値を求めることができません. 
	- これは, これまで紹介した手法での状態発展法にも当てはまります. 

- そこで, これらを経験的な推定値に置き換えます. 

- その前に, 準備として分散環境における各ノードの信号雑音比率を定義します. 
	- 圧縮センシングで定義した信号雑音比率は, 次のように数式展開できます. 
	- このとき, 各ノードにおける信号雑音比率を次のように定義すると, 非分散環境での観測雑音の分散$\sigma$は各ノードの観測雑音の分散$\sigma_p$の総和であると考えることができます. 

---
# 分散的直交近似メッセージ伝搬法
<!-- 
_header: "提案手法: 分散的直交近似メッセージ伝搬法"
-->
以上の準備を踏まえ, 経験的な推定値への置き換えに移りたいと思います. 

- まず文献[4]に従い, 状態発展法の数式をスライド右上のように経験的な推定値に置き換えます. 
- ここで, 各ノードにおける推定値をスライド左下の2式のように定義します. 
- このとき, 先ほどの経験的な推定値は各ノードの推定値の総和であると考えることができます. 

---
# GCOAMP
<!-- 
_header: "提案手法: 分散的直交近似メッセージ伝搬法"
-->
- 提案手法DOAMPは推定解の更新にDivergence-Free関数を用いるため, すべての成分が必要となり, 前述のGCAMPを単純に適用させることはできません
- そこで, 集約しない成分の総和は閾値以下であるため, それらの値に対して近似を行うことで補う手法を提案します. これを以下ではGCOAMPと呼ぶこととします. 

- GCOAMPはさきほど定義した各ノードの閾値$\tau[p]$を用いることでより適した形で集約することで, 再構成の精度を維持したまま通信コストを抑えることができます. 

---
# GCOAMP
<!-- 
_header: "提案手法: 分散的直交近似メッセージ伝搬法"
-->
- GCOAMPは5つの処理から構成され, 
	- STEP1では, 各ノードの閾値$\tau[p]$を基準に, 超過する絶対値を持つ成分のみを中央ノードと通信し共有します. 
		- GCAMPでは基準として閾値の平均値を調節した値を用いていましたが, GCOAMPでは各ノードの閾値を用いています. 
	- STEP2では, $n$ごとに集約した成分の総和$z[n]$を用いて各$n$の判定値を計算し, 各要素で判定値が閾値を超える$n$の成分を各ノードに要求します. 
	- STEP3では, 各ノードで中央ノードから要求された成分のうち, STEP1で共有しなかった成分のみ中央ノードに送信します. 

---
# GCOAMP
<!-- 
_header: "提案手法: 分散的直交近似メッセージ伝搬法"
-->
- (次のスライドへ)
	- STEP4では, 集約された閾値を超える可能性のある候補に対して, 軟判定閾値関数を用いて仮の推定解$\bm{u}$を求めます. 
	- STEP5では, 閾値以下と見なされた成分に対し, STEP2で計算した$z[n]$と, (-1, 1)の範囲での標準正規乱数を用いた近似で補います. そして, これらの値を用いてDivergence-Free関数で推定解を更新します. 

---
# 高次元な信号に対する再構成性能の比較
<!-- 
_header: "数値シミュレーション"
-->
提案手法とこれまで紹介した手法に対し数値シミュレーションで性能を比較します. 
- まず, 高次元な信号に対する再構成性能の比較をします.

- 数値シミュレーションは以下のような諸元で行います. 
	- 次元数$N = 4000$の原信号を$M = 2000$回の観測から再構成します. 

- また, 評価する指標として平均二乗誤差と通信コスト比を用います. 
	- ここで, 通信コスト比はGCAMP及びGCOAMPを用いた場合の通信コストと, 通信コストを削減せずすべての成分を中央ノードに送る場合の通信コストとの比として定義しています. 

- 原信号はガウス・ベルヌーイ分布に従うものとします. 
- また, 前述のGCAMPを適用させたDAMPでは指定された反復回数での再構成が難しいため, GCOAMPのSTEP1~4の処理をGCAMPとしてDAMPに適用させます. 

---
# 高次元な信号に対する再構成性能の比較
<!-- 
_header: "数値シミュレーション (i.i.d.ガウス行列)"
-->
まず, 観測行列にi.i.d.ガウス行列を用いる場合の結果を示します. 
- 左のグラフは通信コスト比, 右のグラフは原信号と再構成信号とのMSEに関する結果です. 
- ここでGCAMPはGCAMPを適用させたDAMP, GCOAMPはGCOAMPを適用させたDOAMPを指しています. 

- 左のグラフからはすべての成分を中央ノードに送る場合と比べて, 両手法が通信コストを削減できていることが確認できます. 
	- GCAMPは８割弱の通信コストがかかってていますが, その後減少し続け最終的に7割弱までに抑えています. 
	- また, GCOAMPは初め9割弱の通信コストがかかっていますが, GCAMPと同じような推移で最終的に8割程度に落ち着く様子が確認できます. 

---
# 高次元な信号に対する再構成性能の比較
<!-- 
_header: "数値シミュレーション (i.i.d.ガウス行列)"
-->
- 右のグラフからはGCOAMPがOAMPよりも性能が高いことが確認できます. 
	- また, GCAMPは初めはAMPと等しい性能で推移していましたが, 途中から再構成がうまく働かなくなり最終的には悪い性能を示しました. 

- 研究で行ったシミュレーション結果によると，提案手法であるGCOAMPはノード間の通信コストを削減していますが，元のOAMPより優れたMSEを示しています．この数値結果の正当性については注意を払って検証を行っていますが，現在までに誤りなどは発見および特定はされていません．とはいえ，直感には反する現象でもありますので，今後引き続き検討を継続する必要があると考えています．また，この結果が正しいと仮定した場合に，その原理の解明は今後の課題と考えています．

---
# 高次元な信号に対する再構成性能の比較
<!-- 
_header: "数値シミュレーション (ユニタリ不変行列)"
-->
次に, 観測行列にユニタリ不変行列を用いる場合の結果を示します. 
- さき程と同様に, 左のグラフは通信コスト比, 右のグラフはMSEに関する結果です. 
- AMPとDAMPはMSEが発散するためグラフから割愛しています.  

- 左のグラフからはGCOAMPが通信コストを削減できていることが確認できます. 
	- GCOAMPはi.i.d.ガウス行列の場合と同様に, 初めに9割弱の通信コストがかかっていますが, 最終的に8割程度に収まっていることが分かります. 

- 右のグラフより, ユニタリ不変行列を用いた場合も，本研究で行ったシミュレーション結果では，再構成信号のMSEについては前ページのi.i.d.ガウス行列の場合と同様の傾向が観察されています．

---
# 条件数の増加に対する再構成性能の比較
<!-- 
_header: "数値シミュレーション"
-->
続いて, 条件数の増加に対する再構成性能の比較を行います. 
- 問題設定はスライド左上のように設定します. 
- グラフに横軸を条件数, 縦軸をMSEとして示します. 
- グラフから, 全体的にGCOAMPを適用させたDOAMPがOAMPよりも高い頑健性を示しています. 
- また, 条件数が$10^3$と比較的小さい場合, DOAMPのPINVはOAMPのLMMSEよりも性能が上回っていることが分かります. 
	- LMMSEでは反復ごとに更新式で用いる行列$\bm{W}$を生成しなければならず, 計算コストや通信コストが余計にかかります. 
	- そのため, 条件数が大きすぎない場合にはDOAMPのPINVは効率よく精度の高い再構成を行えると考えられます. 

---
# まとめ

- 最後に本研究のまとめに入りたいと思います. 
	- 本研究ではDAMPの観測行列を緩和するためDOAMPを提案しました. 
	- また, 通信コストを削減するためGCOAMPを提案しました. 
	- そして, 数値シミュレーションを行うことで通信コスト比と再構成性能の比較を行いました. 
		- 本研究で行ったシミュレーションによると，提案手法は通信量を削減する一方で，MSE が小さくなっています．この結果に対する検証や解明は今後の課題となりますが，ご意見などを頂けるようなら幸いに存じます．

- 今後の展望としては, 通信コストをさらに削減することが挙げられます. 

以上で発表を終わりたいと思います. 
ご清聴ありがとうございました. 